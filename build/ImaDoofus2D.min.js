// Copyright ImaDoofus 2021. This file is licensed under the MIT license.
// https://github.com/ImaDoofus/ImaDoofus2D
!function(){var t,e,i,l,o,r,n=[],h=[],a=0;window.Renderer=function(i){r=this,e=(t=i).getContext("2d"),this.backgroundColor="#ffffff"},window.Rect=function(t,e,i,l,o="black"){this.type="rect",this.x=t,this.y=e,this.width=i,this.height=l,this.rotation=0,this.color=o,this.border={},this.snap=(()=>{let t=n.indexOf(this);t>-1&&n.splice(t,1)}),n.push(this)},window.Circle=function(t,e,i,l="black"){this.type="circle",this.x=t,this.y=e,this.radius=i,this.color=l,this.border={},this.delete=(()=>{let t=n.indexOf(this);t>-1&&n.splice(t,1)}),n.push(this)},window.Triangle=function(t,e,i,l="black"){this.type="triangle",this.x=t,this.y=e,this.radius=i,this.color=l,this.border={},this.delete=(()=>{let t=n.indexOf(this);t>-1&&n.splice(t,1)}),n.push(this)},window.Texture=function(t,e,i){return new Promise((l,o)=>{let r=document.createElement("canvas"),n=r.getContext("2d"),h=new Image;h.onload=function(){let t=h;r.width=e,r.height=i,n.drawImage(h,0,0,e,i);let o=r.toDataURL(),a=new Image;a.src=o,a.onload=function(){t=n.createPattern(a,"repeat"),console.log(t),l(t)}},h.crossOrigin="Anonymous",h.src=t})},window.requestAnimationFrame(function s(c){i=(c-l)/1e3;l=c;if(void 0!==r){e.fillStyle=r.backgroundColor,e.fillRect(0,0,t.width,t.height);for(let t=0;t<n.length;t++){let i=n[t];if("rect"===i.type){e.save();let t=i.x,l=i.y,o=0,r=0;if(0!==i.rotation&&(o+=i.x+i.width/2,r+=i.y+i.height/2,e.translate(o,r),e.rotate(i.rotation*(Math.PI/180)),t=-i.width/2,l=-i.height/2),void 0!==i.border.color){e.fillStyle=i.border.color;let t=i.border.width;e.fillRect(i.x-t,i.y-t,i.width+2*t,i.height+2*t)}if(void 0===i.texture)e.fillStyle=i.color;else{let o=new DOMMatrix;pattern=i.texture,"CanvasPattern"===i.texture.constructor.name&&(pattern.setTransform(o.translate(t,l)),e.fillStyle=pattern)}e.fillRect(t,l,i.width,i.height),e.restore()}if("circle"===i.type){if(void 0!==i.border.color){e.fillStyle=i.border.color;let t=i.border.width;e.beginPath(),e.arc(i.x,i.y,i.radius+t,0,2*Math.PI),e.fill(),e.closePath()}e.fillStyle=i.color,e.beginPath(),e.arc(i.x,i.y,i.radius,0,2*Math.PI),e.fill(),e.closePath()}}if(h.push(1/i||60),c-a>500){a=c;let t=0;for(let e=0;e<h.length;e++)t+=h[e];o=Math.round(t/h.length*100)/100,h=[]}let l=(new Date).toLocaleString();width=Math.max(7.5*l.length,10*t.id.length),e.fillStyle="black",e.fillRect(4,4,width,60),e.fillStyle="white",e.font="12pt Arial",e.fillText(`${t.id}`,7,20),e.font="10pt Arial",e.fillText(`${l}`,9,40),e.fillText(`${o} fps`,9,55)}window.requestAnimationFrame(s)})}();
